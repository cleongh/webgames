<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"><title>WebAudio</title><meta name="author" content="Carlos León"><style>.underline{text-decoration:underline}</style><link rel="stylesheet" href="tooling.reveal.4b097e00.css"><link rel="stylesheet" href="tooling.reveal.64dafdde.css" id="theme"><link rel="stylesheet" href="tooling.reveal.c1a625de.css"><link rel="stylesheet" href="tooling.reveal.fdb16a0d.css"></head><body> <div class="reveal"> <div class="slides"> <section id="sec-title-slide"> <h1 class="title">WebAudio</h1><h2 class="author">Carlos León</h2><h2 class="email"><a href="mailto:cleon@ucm.es">cleon@ucm.es</a></h2> </section> <section> <section id="slide-sonido-en-un-computador"> <h2 id="sonido-en-un-computador">Sonido en un computador</h2> </section> <section id="slide-el-sonido"> <h3 id="el-sonido">El sonido</h3> <p> De Wikipedia: </p> <blockquote> <p> es cualquier fenómeno que involucre la propagación de ondas mecánicas (sean audibles o no), generalmente a través de un fluido (u otro medio elástico) que esté generando el movimiento vibratorio de un cuerpo </p> </blockquote> </section> <section id="slide-características-del-sonido"> <h3 id="características-del-sonido">Características del sonido</h3> </section> <section> <p> Lo que llamamos sonido es el resultado de: </p> <ol> <li>la vibración del aire, que llega a nuestro oreja (esto es una <a href="https://es.wikipedia.org/wiki/Onda_mec%C3%A1nica">onda mecánica</a>)</li> <li>La oreja, gracias a su forma, hace que la onda rebote y se refleje en la dirección del conducto auditivo</li> <li>Así, la onda llega al tímpano, que vibra</li> <li>La vibración es transmitida al <a href="https://es.wikipedia.org/wiki/Nervio_vestibulococlear">nervio auditivo</a>.</li> <li>El nervio llega a nuestro cerebro</li> <li>Ocurren muchas cosas (muchas de las cuáles aún ignoramos)</li> <li>Percibimos, conscientemente, el <b>sonido</b></li> </ol> </section> <section id="slide-caracteristicas-de-una-onda"> <h3 id="caracteristicas-de-una-onda">Caracteristicas de una onda</h3> <p> La longitud de onda (simbolizada por <b>λ</b>) es la distancia entre dos crestas o valles seguidos. </p> <p> El periodo <b>T</b> es el tiempo requerido para que el movimiento de oscilación de la onda describa un ciclo completo </p> </section> <section> <div id="org6378f30" class="figure"> <p><img src="nonsinusoidal_wavelength.5b886c60.jpg" alt="nonsinusoidal_wavelength.jpg"> </p> <p><span class="figure-number">Figura 1: </span>La amplitud de la onda es la altura de la cresta</p> </div> </section> <section> <p> La frecuencia <b>f</b> es el número de ciclos completos transcurridos en una unidad de tiempo </p> <p> f = 1 / T </p> <p> Hercio (Hz) es el número de veces que se repite una onda por segundo </p> <blockquote> <p> 100 kHzs = 100.000 veces por segundo </p> </blockquote> </section> <section id="slide-cómo-producir-sonido"> <h3 id="cómo-producir-sonido">¿Cómo producir sonido?</h3> </section> <section> <p> Para reproducir sonido es necesario generar ondas que se propaguen a través de un fluido </p> </section> <section> <p> Para hacer esto en un dispositivo moderno, tenemos que <b>enviar señales a un altavoz</b> </p> </section> <section> <p> Para comunicarnos con el altavoz, usamos generalmente un <i>chip de audio</i> </p> </section> <section> <p> En general: </p> <ol> <li>creamos la representación de una onda compleja (muchos números reales)</li> <li>le mandamos esta representación <b>digital</b> al chip</li> <li>el chip la convierte en una señal electrónica <b>analógica</b></li> <li>le señal eléctrica hace que el altavoz "mueva" el aire, produciendo el sonido</li> </ol> </section> <section id="slide-y-qué-tiene-que-ver-eso-con-un-mp3"> <h3 id="y-qué-tiene-que-ver-eso-con-un-mp3">¿Y qué tiene que ver eso con un MP3?</h3> </section> <section> <p> Un archivo de audio en formato de onda (hay otros diferentes, como MIDI) tiene esa representación numérica/digital de la onda compleja que define el sonido </p> </section> <section> <p> El reproductor de audio puede tener que preprocesar el audio que hay en el archivo. Por ejemplo, para <b>descomprimirlo</b> (como en el caso de MP3) </p> <p> Después, se comunica con el chip de audio, "entregándole" (a través de varias capas software y hardware) la música en onda "bruta" </p> </section> <section> <p> Hay que tener en cuenta que el sonido <b>puede ocupar mucho espacio</b> </p> <p> Cuanta más fidelidad queramos reproducir, más precisión (<i>resolución</i>) necesitaremos almacenar </p> <p> Es decir, más <b>números</b> </p> </section> <section> <p> Cuando la precisión es muy grande, el archivo de audio puede tener un tamaño de varias decenas de megas para una canción de 2 o 3 minutos </p> <p> Esto ocurre con formatos como <b>WAV o AIFF</b> (sin compresión) </p> <p> Por tanto, usamos <b>compresión</b> </p> </section> <section> <p> Cuando usamos compresión, tenemos dos familias de formatos: </p> <ul> <li>formatos sin pérdida: el audio, al comprimir y descomprimir, no pierde datos (FLAC)</li> <li>formatos con pérdida: el audio, al ser comprimido, pierde fidelidad. Pero, generalmente, esta pérdida no se nota por el oyente, y la compresión es mucho mayor (MP3)</li> </ul> </section> <section> <p> El oído humano (en general) distingue frecuencias entre 20 Hz y 20 KHz </p> <p> La voz masculina ronda los 100-200 Hz, y la femenina los 150-300 Hz (la infantil es algo más aguda) </p> </section> <section> <p> media audible 2KHz - 4 KHz) <img src="umbral.af062484.png" alt="umbral.png"> </p> </section> <section> <p> Ejemplo tono no audible para adultos </p> <p> <a href="https://www.youtube.com/watch?v=Ez93oblQAJg">Tono no audible adultos</a> </p> </section> <section> <p> Comprimir consiste en eliminar las frecuencias no audibles, aunque siempre nos llevamos por delante algo que podríamos oír </p> <p> Con suerte, eso que eliminamos no será muy relevante </p> </section> </section> <section> <section id="slide-música-y-sonido"> <h2 id="música-y-sonido">Música y sonido</h2> </section> <section> <p> Toda la música es sonido </p> </section> <section> <p> En general, asumimos que la música es sonido con ciertas propiedades (armonía, estructura&#x2026;) </p> </section> <section> <p> En términos técnicos, es muy normal representar la música y el sonido de maneras diferentes </p> </section> <section> <p> Generalmente, la música en un videojuego se reproduce de forma <b>continua</b> como elemento decorativo </p> <p> Los sonidos se lanzan y se espera que estén perfectamente <b>sincronizados</b> con la acción que los lanzan </p> </section> <section> <p> Es muy normal que, como recursos, los sonidos estén en archivos de audio en formatos sin compresión y sean cortos </p> </section> <section> <p> La música, normalmente, está codificada como pistas, de la misma forma que solemos escucharla en reproductores modernos (<a href="https://es.wikipedia.org/wiki/MP3">MP3</a>, <a href="https://es.wikipedia.org/wiki/Ogg">OGG</a>) </p> </section> </section> <section> <section id="slide-reproducir-audio-en-un-navegador"> <h2 id="reproducir-audio-en-un-navegador">Reproducir audio en un navegador</h2> </section> <section> <p> Hoy en día las tecnologías web permiten reproducir audio desde el navegador </p> </section> <section id="slide-elemento-audio"> <h3 id="elemento-audio">Elemento <code>&lt;audio&gt;</code></h3> <div class="org-src-container"> <pre><code class="html">&lt;audio controls&gt;
  &lt;source src="https://upload.wikimedia.org/wikipedia/commons/4/45/Dryoscopus_cubla_okavangensis%2C_roepe%2C_27_s%2C_voorstedelike_Pretoria%2C_b.mp3" type="audio/mp3"&gt;
  Tu navegador no soporta audio
&lt;/audio&gt;
</code></pre> </div> <audio controls> <source src="https://upload.wikimedia.org/wikipedia/commons/4/45/Dryoscopus_cubla_okavangensis%2C_roepe%2C_27_s%2C_voorstedelike_Pretoria%2C_b.mp3" type="audio/mp3"> Tu navegador no soporta audio </audio> </section> </section> <section> <section id="slide-web-audio"> <h2 id="web-audio">Web Audio</h2> <p> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API">Web Audio</a> es una forma de reproducir audio en el navegador a bajo nivel </p> </section> <section> <p> Con Web Audio, podemos crear nuestra propia onda de sonido: </p> <div class="org-src-container"> <pre><code class="js">// Creamos un "contexto"
const context = new AudioContext();
// Creamos un oscilador (genera una onda sencilla)
const oscillator = context.createOscillator();
// Conectamos el oscilador con los altavoces
oscillator.connect(context.destination);
// Empezamos la reproducción
oscillator.start(context.currentTime);
// Finalizamos la reproducción 5 segundos después
oscillator.stop(context.currentTime + 5);
</code></pre> </div> </section> <section> <p> Web Audio no reemplaza al elemento <code>&lt;audio&gt;</code> </p> <p> Para reproducir una pista de audio en un archivo estándar, usar una etiqueta <code>&lt;audio&gt;</code> es generalmente mucho más razonable </p> </section> <section> <p> Web Audio está diseñada de forma que, con la API, construimos nodos </p> <div id="orgcb450c6" class="figure"> <p><img src="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Using_Web_Audio_API/graphpan.jpg" alt="graphpan.jpg"> </p> <p><span class="figure-number">Figura 2: </span>Ejemplo de nodos Web Audio</p> </div> </section> <section> <p> La información de la "onda" se enruta entre los nodos, de forma que encadenamos procesos </p> <p> Es muy análogo a un montaje electrónico en el que vamos modificando la onda </p> </section> <section> <div id="org271738a" class="figure"> <p><img src="nodos.01fe1a2b.svg" alt="nodos.svg" class="org-svg"> </p> <p><span class="figure-number">Figura 3: </span>Conectando nodos Web Audio</p> </div> </section> <section> <div class="org-src-container"> <pre><code class="js">const context = new AudioContext();
const oscillator = context.createOscillator();
oscillator.start(context.currentTime);
oscillator.stop(context.currentTime + 5);
// Creamos un nodo nuevo de ganancia
var gainNode = context.createGain();
// Conectamos la salida del oscilador al nodo de ganancia
oscillator.connect(gainNode);
// Conectamos el nodo de ganancia a la salida
gainNode.connect(context.destination);
// Cambiamos el volumen
gainNode.gain.value = 0.5;
</code></pre> </div> </section> </section> <section> <section id="slide-referencias-y-tutoriales"> <h2 id="referencias-y-tutoriales">Referencias y tutoriales</h2> <ul> <li><a href="https://www.html5rocks.com/en/tutorials/webaudio/intro/">Getting Started with Web Audio API</a></li> <li><a href="https://code.tutsplus.com/es/tutorials/the-web-audio-api-make-your-own-web-synthesizer--cms-23887">La Web Audio API: Crea Tu Propio Sintetizador Web</a></li> <li><a href="https://www.toptal.com/web/web-audio-api-tutorial">Web Audio API: Why Compose When You Can Code?</a></li> </ul> </section> </section> </div> </div> <script src="tooling.reveal.62c78f3a.js"></script> <script src="tooling.reveal.f05d24be.js"></script> <script src="tooling.reveal.f6a6f820.js"></script> <script src="tooling.reveal.d2982244.js"></script> <script>Reveal.initialize({controls:!0,progress:!0,history:!0,center:!0,slideNumber:"c",rollingLinks:!1,keyboard:!0,mouseWheel:!1,fragmentInURL:!1,hashOneBasedIndex:!1,pdfSeparateFragments:!0,overview:!0,transition:"none",transitionSpeed:"default",plugins:[RevealSearch,RevealHighlight,RevealZoom],dependencies:[]});</script> </body></html>